<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Email Spam Detection System</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
  </head>

  <body>
    <div class="container">
      <h1>Email Spam Detection System</h1>

      <div class="tabs">
        <button class="tab-button active" onclick="openTab('text-tab')">
          <i class="fas fa-align-left"></i> Text Input
        </button>

        <button class="tab-button" onclick="openTab('file-tab')">
          <i class="fas fa-upload"></i> File Upload
        </button>
      </div>

      <div id="text-tab" class="tab-content active">
        <form action="/" method="POST">
          <label for="email">Enter Email Content:</label>

          <textarea
            id="email"
            name="email"
            rows="8"
            placeholder="Paste your email content here..."
            {%
            if
            email
            %}value="{{ email }}"
            {%
            endif
            %}
          >
{% if email %}{{ email }}{% endif %}</textarea
          >

          <input type="submit" value="Check Spam" />
        </form>
      </div>

      <div id="file-tab" class="tab-content">
        <form action="/upload" method="POST" enctype="multipart/form-data">
          <label for="file-upload" class="file-upload-label">
            <i class="fas fa-cloud-upload-alt"></i>
            <span>Choose a file or drag it here</span>
            <input
              type="file"
              id="file-upload"
              name="file"
              accept=".txt,.eml"
            />
          </label>

          <div class="file-info" id="file-info">No file selected</div>
          <input type="submit" value="Check Spam" />
        </form>
      </div>

      {% if prediction is not none %}
      <div
        class="prediction-result {% if prediction == 1 %}spam{% else %}not-spam{% endif %}"
      >
        {% if prediction == 1 %}
        <i class="fas fa-exclamation-triangle"></i>
        <span>SPAM DETECTED: This email is likely spam</span>
        {% else %}
        <i class="fas fa-check-circle"></i>
        <span>LEGITIMATE: This email appears safe</span>
        {% endif %}
      </div>
      {% endif %}
    </div>

    <script>
      // Tab functionality
      function openTab(tabId) {
        // Hide all tab contents
        document.querySelectorAll(".tab-content").forEach((tab) => {
          tab.classList.remove("active");
        });

        // Deactivate all tab buttons
        document.querySelectorAll(".tab-button").forEach((button) => {
          button.classList.remove("active");
        });

        // Activate selected tab
        document.getElementById(tabId).classList.add("active");
        event.currentTarget.classList.add("active");
      }

      // File upload display
      document
        .getElementById("file-upload")
        .addEventListener("change", function (e) {
          const fileInfo = document.getElementById("file-info");
          if (this.files.length > 0) {
            fileInfo.textContent = this.files[0].name;
          } else {
            fileInfo.textContent = "No file selected";
          }
        });

      // Drag and drop functionality
      const fileUploadLabel = document.querySelector(".file-upload-label");
      fileUploadLabel.addEventListener("dragover", (e) => {
        e.preventDefault();
        fileUploadLabel.classList.add("dragover");
      });

      fileUploadLabel.addEventListener("dragleave", () => {
        fileUploadLabel.classList.remove("dragover");
      });

      fileUploadLabel.addEventListener("drop", (e) => {
        e.preventDefault();
        fileUploadLabel.classList.remove("dragover");
        document.getElementById("file-upload").files = e.dataTransfer.files;
        document.getElementById("file-info").textContent =
          e.dataTransfer.files[0].name;
      });
    </script>
  </body>
</html>
